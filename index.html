import React from 'react';
import { 
  BarChart, Bar, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, ComposedChart
} from 'recharts';
import { 
  TrendingUp, 
  Award, 
  Home, 
  BookOpen, 
  MessageCircle, 
  AlertCircle,
  CheckCircle2,
  ArrowRight,
  Target,
  FileText
} from 'lucide-react';

// 模擬數據：根據圖片內容推估的關鍵指標數據
const surveyData = [
  { category: '師資熱忱', year112: 96.5, year113: 97.5, label: '師資教學氛圍' },
  { category: '硬體設施', year112: 93.8, year113: 95.8, label: '值班室/休息室' },
  { category: '教學活動', year112: 95.1, year113: 96.2, label: '全院/科部教學' },
  { category: '工作負荷', year112: 96.4, year113: 97.1, label: '工作學習平衡' },
  { category: '溝通行政', year112: 95.2, year113: 96.6, label: '問題解決/支援' },
  { category: '總平均',   year112: 95.7, year113: 96.7, label: '整體表現' },
];

const ComparisonTable = () => (
  <div className="border border-slate-300 shadow-sm bg-white">
    <table className="w-full text-sm text-left text-slate-700">
      <thead className="text-xs text-white uppercase bg-slate-800">
        <tr>
          <th className="px-6 py-4 font-serif text-base tracking-wide border-r border-slate-700">面向</th>
          <th className="px-6 py-4 font-serif text-base tracking-wide border-r border-slate-700">112 學年度</th>
          <th className="px-6 py-4 font-serif text-base tracking-wide border-r border-slate-700">113 學年度</th>
          <th className="px-6 py-4 font-serif text-base tracking-wide border-r border-slate-700">趨勢</th>
          <th className="px-6 py-4 font-serif text-base tracking-wide">改善建議 (PDCA)</th>
        </tr>
      </thead>
      <tbody className="divide-y divide-slate-200">
        <tr className="bg-white hover:bg-slate-50">
          <td className="px-6 py-4 font-medium text-slate-900 border-r border-slate-200">
            <div className="flex items-center gap-2">
              <Award className="w-4 h-4 text-slate-600" /> 師資熱忱與教學氛圍
            </div>
          </td>
          <td className="px-6 py-4 border-r border-slate-200">高度滿意 (約 96.5)</td>
          <td className="px-6 py-4 font-bold text-slate-900 border-r border-slate-200">表現頂尖、全院最高 (達 97.5)</td>
          <td className="px-6 py-4 border-r border-slate-200"><span className="text-slate-700 font-semibold border-b-2 border-green-600">穩定優異</span></td>
          <td className="px-6 py-4 text-slate-600">推動「優良臨床教師表揚」，邀請高滿意度導師分享心得，維持傳承。</td>
        </tr>
        <tr className="bg-slate-50 hover:bg-slate-100">
          <td className="px-6 py-4 font-medium text-slate-900 border-r border-slate-200">
            <div className="flex items-center gap-2">
              <Home className="w-4 h-4 text-slate-600" /> 硬體空間與設施
            </div>
          </td>
          <td className="px-6 py-4 text-slate-500 italic border-r border-slate-200">相對弱項 (93.5-94.2)</td>
          <td className="px-6 py-4 font-bold text-slate-900 border-r border-slate-200">進步幅度最大 (大幅升至 95.7-95.9)</td>
          <td className="px-6 py-4 border-r border-slate-200"><span className="text-slate-700 font-semibold border-b-2 border-blue-600">顯著改善</span></td>
          <td className="px-6 py-4 text-slate-600">持續進行「軟裝優化」（如汰換寢具、補給品），提升使用體驗。</td>
        </tr>
        <tr className="bg-white hover:bg-slate-50">
          <td className="px-6 py-4 font-medium text-slate-900 border-r border-slate-200">
            <div className="flex items-center gap-2">
              <BookOpen className="w-4 h-4 text-slate-600" /> 教學活動與課程
            </div>
          </td>
          <td className="px-6 py-4 border-r border-slate-200">表現持平 (約 94.7-95.6)</td>
          <td className="px-6 py-4 font-bold text-slate-900 border-r border-slate-200">全面提升 (突破 96 分)</td>
          <td className="px-6 py-4 border-r border-slate-200"><span className="text-slate-700 font-semibold border-b-2 border-slate-400">改善</span></td>
          <td className="px-6 py-4 text-slate-600">針對演講進行「主題意願調查」，協助各科將教學內容「結構化」。</td>
        </tr>
        <tr className="bg-slate-50 hover:bg-slate-100">
          <td className="px-6 py-4 font-medium text-slate-900 border-r border-slate-200">
            <div className="flex items-center gap-2">
              <TrendingUp className="w-4 h-4 text-slate-600" /> 工作負荷與學習平衡
            </div>
          </td>
          <td className="px-6 py-4 border-r border-slate-200">滿意度佳 (約 96.4)</td>
          <td className="px-6 py-4 font-bold text-slate-900 border-r border-slate-200">優於往年 (升至 97.1 以上)</td>
          <td className="px-6 py-4 border-r border-slate-200"><span className="text-slate-700 font-semibold border-b-2 border-slate-400">改善</span></td>
          <td className="px-6 py-4 text-slate-600">持續監測工時與學習成效平衡，維持排班與代理制度穩定。</td>
        </tr>
        <tr className="bg-white hover:bg-slate-50">
          <td className="px-6 py-4 font-medium text-slate-900 border-r border-slate-200">
            <div className="flex items-center gap-2">
              <MessageCircle className="w-4 h-4 text-slate-600" /> 溝通管道與問題解決
            </div>
          </td>
          <td className="px-6 py-4 text-slate-500 italic border-r border-slate-200">有待加強 (約 95.2)</td>
          <td className="px-6 py-4 font-bold text-slate-900 border-r border-slate-200">各項指標均高 (升至 96.6 以上)</td>
          <td className="px-6 py-4 border-r border-slate-200"><span className="text-slate-700 font-semibold border-b-2 border-blue-600">顯著改善</span></td>
          <td className="px-6 py-4 text-slate-600">落實座談會意見「閉環管理 (Close the loop)」，確保問題有具體回應。</td>
        </tr>
      </tbody>
    </table>
  </div>
);

const App = () => {
  return (
    <div className="min-h-screen bg-gray-100 font-sans text-slate-800 pb-12">
      {/* Header Section */}
      <header className="bg-slate-900 border-b-4 border-yellow-600 sticky top-0 z-20 shadow-md">
        <div className="max-w-7xl mx-auto px-6 py-5 flex justify-between items-center">
          <div className="flex items-center gap-4">
            <div className="bg-white/10 p-2 rounded-sm border border-white/20">
              <FileText className="w-6 h-6 text-yellow-500" />
            </div>
            <div>
              <h1 className="text-2xl font-serif font-bold text-white tracking-wide">年度實習滿意度分析報告</h1>
              <p className="text-sm text-slate-300 uppercase tracking-wider mt-0.5">112 vs 113 學年度比較評估</p>
            </div>
          </div>
          <div className="hidden md:block">
             <div className="text-right border-l border-slate-600 pl-6">
                <p className="text-xs text-slate-400 uppercase tracking-widest">總平均成長幅度</p>
                <p className="text-xl font-serif font-bold text-yellow-500 flex items-center justify-end gap-2">
                  + 1.0 <TrendingUp className="w-5 h-5" />
                </p>
             </div>
          </div>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-6 py-10 space-y-10">
        
        {/* Key Metrics Cards - Formal Style */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          {/* Card 1 */}
          <div className="bg-white p-6 border-t-4 border-slate-400 shadow-sm">
            <div className="flex justify-between items-start mb-4">
              <div>
                <p className="text-xs font-bold text-slate-500 uppercase tracking-wider">112 學年度基準</p>
                <h3 className="text-4xl font-serif font-bold text-slate-600 mt-2">95.7</h3>
              </div>
              <div className="p-2 bg-slate-100 rounded-sm">
                <span className="text-slate-600 text-xs font-bold font-serif">基準年</span>
              </div>
            </div>
            <div className="w-full bg-slate-200 h-1 mt-4">
              <div className="bg-slate-400 h-1" style={{ width: '95.7%' }}></div>
            </div>
          </div>

          {/* Card 2 */}
          <div className="bg-white p-6 border-t-4 border-blue-900 shadow-sm relative">
            <div className="flex justify-between items-start mb-4">
              <div>
                <p className="text-xs font-bold text-blue-900 uppercase tracking-wider">113 學年度成果</p>
                <h3 className="text-4xl font-serif font-bold text-blue-900 mt-2">96.7</h3>
              </div>
              <div className="p-2 bg-blue-50 rounded-sm">
                <TrendingUp className="w-5 h-5 text-blue-900" />
              </div>
            </div>
            <div className="w-full bg-slate-200 h-1 mt-4">
              <div className="bg-blue-900 h-1" style={{ width: '96.7%' }}></div>
            </div>
            <p className="mt-3 text-sm text-slate-600 font-medium flex items-center">
              <span className="text-green-700 mr-2">▲ 1.0</span> 較去年顯著成長
            </p>
          </div>

          {/* Card 3 - Highlight */}
          <div className="bg-slate-800 p-6 border-t-4 border-yellow-600 shadow-sm text-white">
            <h3 className="text-lg font-serif font-semibold mb-3 flex items-center gap-2 text-yellow-500">
              <Target className="w-5 h-5" />
              關鍵績效指標 (KPI) 亮點
            </h3>
            <p className="text-slate-300 text-sm leading-relaxed mb-4">
              本年度針對「硬體空間」進行重點改善，滿意度數據顯示為進步幅度最大之指標，成功將痛點轉化為亮點。
            </p>
            <div className="flex items-center gap-2 text-xs border border-slate-600 px-3 py-1.5 w-fit bg-slate-700/50">
              <CheckCircle2 className="w-3 h-3 text-green-400" />
              <span className="tracking-wide text-slate-200">硬體設施滿意度顯著躍升</span>
            </div>
          </div>
        </div>

        {/* Chart Section - Formal Style */}
        <div className="bg-white p-8 shadow-sm border border-slate-200">
          <div className="mb-8 border-b border-slate-100 pb-4">
            <h2 className="text-xl font-serif font-bold text-slate-900 border-l-4 border-blue-900 pl-3">
              各面向滿意度趨勢分析
            </h2>
            <p className="text-sm text-slate-500 mt-2 ml-4">
              112 vs 113 學年度數據對比圖表 (Data Comparison)
            </p>
          </div>
          <div className="h-[400px] w-full">
            <ResponsiveContainer width="100%" height="100%">
              <ComposedChart data={surveyData} margin={{ top: 20, right: 30, bottom: 20, left: 20 }}>
                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#e2e8f0" />
                <XAxis 
                  dataKey="label" 
                  scale="point" 
                  padding={{ left: 30, right: 30 }} 
                  tick={{fill: '#475569', fontSize: 13, fontFamily: 'serif'}} 
                  axisLine={{ stroke: '#cbd5e1' }}
                />
                <YAxis 
                  domain={[90, 100]} 
                  tick={{fill: '#475569', fontFamily: 'sans-serif'}} 
                  axisLine={{ stroke: '#cbd5e1' }}
                />
                <Tooltip 
                  contentStyle={{ 
                    backgroundColor: '#fff', 
                    borderRadius: '0px', 
                    border: '1px solid #94a3b8', 
                    boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)' 
                  }}
                  itemStyle={{ fontFamily: 'sans-serif', fontSize: '12px' }}
                />
                <Legend wrapperStyle={{ paddingTop: '20px', fontFamily: 'serif' }}/>
                {/* 112年: 灰色/低調 */}
                <Bar 
                  dataKey="year112" 
                  name="112 學年度 (基準)" 
                  barSize={40} 
                  fill="#94a3b8" 
                  radius={[0, 0, 0, 0]} 
                />
                {/* 113年: 深藍/強調 */}
                <Line 
                  type="monotone" 
                  dataKey="year113" 
                  name="113 學年度 (本期)" 
                  stroke="#1e3a8a" 
                  strokeWidth={3} 
                  dot={{ r: 5, fill: '#1e3a8a', strokeWidth: 0 }} 
                  activeDot={{ r: 7, stroke: '#fbbf24', strokeWidth: 2 }} 
                />
              </ComposedChart>
            </ResponsiveContainer>
          </div>
        </div>

        {/* Detailed Analysis - Two Column Report Style */}
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
          {/* 112 Review */}
          <div className="space-y-4">
            <h2 className="text-lg font-serif font-bold text-slate-700 flex items-center gap-3 border-b border-slate-300 pb-2">
              <span className="bg-slate-200 text-slate-700 px-2 py-0.5 text-xs font-sans font-bold">112 學年度</span> 
              執行狀況回顧
            </h2>
            <div className="bg-white p-6 border border-slate-200 h-full">
              <div className="space-y-8">
                <div>
                  <h4 className="font-bold text-slate-800 text-sm uppercase tracking-wide mb-3 border-l-2 border-green-700 pl-2">
                    優勢評估 (Strengths)
                  </h4>
                  <ul className="list-disc list-outside text-slate-600 text-sm space-y-2 ml-4">
                    <li><strong className="text-slate-900 font-serif">師資熱忱高：</strong> 教學氛圍良好，滿意度達 96.5，為穩定基石。</li>
                    <li><strong className="text-slate-900 font-serif">工作平衡佳：</strong> 臨床工作負荷與學習取得平衡，制度運作正常。</li>
                  </ul>
                </div>
                <div>
                  <h4 className="font-bold text-slate-800 text-sm uppercase tracking-wide mb-3 border-l-2 border-red-800 pl-2">
                    待改進事項 (Areas for Improvement)
                  </h4>
                  <ul className="list-disc list-outside text-slate-600 text-sm space-y-2 ml-4">
                    <li><strong className="text-slate-900 font-serif">硬體設施不足：</strong> 值班室與休息空間滿意度最低 (約 93.5)，學員反映頻繁。</li>
                    <li><strong className="text-slate-900 font-serif">溝通管道受限：</strong> 問題解決與行政支援的滿意度相對較低 (95.2)，需加強回應機制。</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          {/* 113 Review */}
          <div className="space-y-4">
            <h2 className="text-lg font-serif font-bold text-blue-900 flex items-center gap-3 border-b border-blue-900 pb-2">
              <span className="bg-blue-900 text-white px-2 py-0.5 text-xs font-sans font-bold">113 學年度</span> 
              執行成效分析
            </h2>
            <div className="bg-white p-6 border border-blue-100 shadow-sm h-full relative">
              <div className="absolute top-0 right-0 w-0 h-0 border-t-[60px] border-t-blue-50 border-l-[60px] border-l-transparent"></div>
              <div className="space-y-8 relative z-10">
                <div>
                  <h4 className="font-bold text-slate-800 text-sm uppercase tracking-wide mb-3 border-l-2 border-blue-600 pl-2">
                    主要成效 (Key Achievements)
                  </h4>
                  <ul className="list-disc list-outside text-slate-600 text-sm space-y-2 ml-4">
                    <li><strong className="text-blue-900 font-serif">弱項轉強：</strong> 硬體空間滿意度大幅提升至 95.8，改善策略奏效。</li>
                    <li><strong className="text-blue-900 font-serif">全面標竿化：</strong> 所有指標均突破 95 分，師資熱忱達 97.5 頂尖水準。</li>
                    <li><strong className="text-blue-900 font-serif">行政效能提升：</strong> 透過「閉環管理」，行政溝通滿意度顯著改善。</li>
                  </ul>
                </div>
                <div>
                  <h4 className="font-bold text-slate-800 text-sm uppercase tracking-wide mb-3 border-l-2 border-yellow-600 pl-2">
                    未來展望 (Future Outlook)
                  </h4>
                  <p className="text-sm text-slate-600 leading-relaxed text-justify">
                    目前已無顯著低分項目。下一階段策略重點在於<strong className="text-slate-900">「維持高標」</strong>以及將教學內容進一步<strong className="text-slate-900">「精緻化與結構化」</strong>，深化教學內涵，避免流於形式。
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>

        {/* Comparison Table */}
        <div className="space-y-4 pt-4">
          <h2 className="text-xl font-serif font-bold text-slate-900 border-l-4 border-slate-700 pl-3">
            重點比較與改善建議彙整表
          </h2>
          <ComparisonTable />
        </div>

        {/* Final Conclusion - Formal Footer */}
        <div className="bg-slate-900 text-slate-300 px-8 py-10 mt-8 border-t-4 border-yellow-600">
          <div className="max-w-4xl mx-auto text-center space-y-6">
            <h2 className="text-2xl font-serif font-bold text-white tracking-wide">總結報告</h2>
            <div className="w-24 h-1 bg-yellow-600 mx-auto"></div>
            <p className="text-slate-300 leading-relaxed">
              113 學年度在維持 112 學年度優良師資基礎上，成功解決了硬體設施的痛點，並優化了行政溝通管道，使整體滿意度上升 1.0 分。<br/>
              未來策略應聚焦於軟硬體細節的持續微調，以及教學品質的深化，以期達到更卓越的教學成效。
            </p>
            
            <div className="flex flex-wrap justify-center gap-6 pt-6">
              <div className="flex items-center gap-2 text-sm font-medium border border-slate-700 px-4 py-2 bg-slate-800">
                <span className="w-2 h-2 bg-yellow-500 rounded-full"></span>
                持續軟裝優化
              </div>
              <div className="flex items-center gap-2 text-sm font-medium border border-slate-700 px-4 py-2 bg-slate-800">
                <span className="w-2 h-2 bg-yellow-500 rounded-full"></span>
                教學內容結構化
              </div>
              <div className="flex items-center gap-2 text-sm font-medium border border-slate-700 px-4 py-2 bg-slate-800">
                <span className="w-2 h-2 bg-yellow-500 rounded-full"></span>
                落實意見回饋閉環
              </div>
            </div>
          </div>
        </div>

      </main>
    </div>
  );
};

export default App;
